# Отладка и производительность

ScrubJS предоставляет встроенные средства для отладки и анализа производительности, которые помогают в разработке и тестировании игр. Однако в финальной версии игры рекомендуется отключать отладочные функции, чтобы снизить нагрузку на браузер.

---

## 1. Отображение ошибок

Во время разработки ScrubJS может отображать **ошибки и предупреждения**, включая:

- Опечатки в методах и свойствах
- Попытки доступа к несуществующим объектам
- Нарушения API

Это реализуется через **прокси-обёртки**, которые отслеживают обращения к объектам и сравнивают их с допустимыми свойствами. Такая проверка облегчает отладку, особенно на ранних этапах.

### Управление отображением ошибок

При создании игры можно включать или отключать вывод ошибок:

```javascript
const game = new Game(
    null, // ширина
    null, // высота
    null, // canvasId
    true, // displayErrors — включено
    'ru'  // язык сообщений
);
```

### Рекомендация

В продакшн-сборке выставляйте `displayErrors = false`, чтобы убрать накладные расходы на отладку и ускорить выполнение.

---

## 2. Отладка коллайдеров

Для визуальной отладки столкновений ScrubJS позволяет **подсвечивать активные коллайдеры** спрайтов и сцен.

### Пример включения отладки коллизий:

```javascript
game.debugCollider = true;
game.debugColor = '#00FF0077'; // Цвет отладочной рамки (зеленый с прозрачностью)
```

После этого каждый спрайт с активным коллайдером будет отображать свою **границу столкновения** поверх графики.

---

## 3. Свойство `debugMode`

Свойство `debugMode` управляет режимом отображения дополнительной информации о спрайтах (например, положение, размеры, имя и т.д.).

### Возможные значения:

- `'none'` — режим отладки отключён
- `'hover'` — информация появляется при наведении мыши на спрайт
- `'forever'` — информация отображается всегда

### Пример:

```javascript
game.debugMode = 'hover'; // Отображать отладку при наведении
```

Полезно, если нужно отследить поведение конкретного объекта на сцене.

---

## 4. Повышение производительности

Чтобы игра работала плавно даже на слабых устройствах, следуйте нескольким рекомендациям:

### Избегайте избыточных вычислений в `forever()`

```javascript
// Негативный пример:
sprite.forever(() => {
    sprite.drawCostume(...); // Новый костюм каждый кадр — затратно
});
```

```javascript
// Хорошо:
if (!sprite.hasCostume('cached')) {
    sprite.drawCostume(...);
}
```

### Минимизируйте количество активно отрисовываемых спрайтов

Используйте `sprite.hidden = true` для объектов вне экрана, чтобы сократить нагрузку на GPU.

### Используйте `pen()` для рисования фона и следов

Вместо создания новых объектов каждый кадр, рисуйте статичные элементы через `stage.pen()`.

### Отключайте отладку перед публикацией

```javascript
game.debugMode = 'none'
game.debugCollider = false;
game.displayErrors = false;
```
